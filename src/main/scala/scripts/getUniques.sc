val bla = """[304160,304163], 538794
  |[304155,304160], 274055
  |[304158,304160], 509967
  |[304158,304160,304163], 273874
  |[304158,304163], 427956
  |[304161,304160], 328334
  |[304161,304163], 316631
  |[304162,304160], 341955
  |[304162,304158], 268673
  |[304162,304163], 291120
  |[304156,304160], 361930
  |[304156,304158], 300154
  |[304156,304163], 301761
  |[304165,304160], 310931
  |[304165,304163], 275438
  |[304166,304163], 309510""".stripMargin

val regex = """\[(.*)\].*""".r

bla
  .split("\n")
  .map {
    case regex(a) => a
  }
  .flatMap(_.split(","))
  .distinct